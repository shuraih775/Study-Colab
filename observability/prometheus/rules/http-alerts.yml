groups:
- name: http
  rules:

  - alert: HttpHighLatencyP95
    expr: |
      histogram_quantile(
        0.95,
        sum by (le) (
          rate(http_server_request_duration_seconds_bucket[5m])
        )
      ) > 0.5
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High HTTP latency (p95)"
      description: "p95 latency > 500ms for 5 minutes"

  - alert: HttpErrorRateHigh
    expr: |
      sum(rate(http_server_request_duration_seconds_count{http_response_status_code=~"5.."}[5m]))
      /
      sum(rate(http_server_request_duration_seconds_count[5m]))
      > 0.05
    for: 3m
    labels:
      severity: critical
    annotations:
      summary: "High HTTP 5xx error rate"
      description: "More than 5% of requests are failing with 5xx"
